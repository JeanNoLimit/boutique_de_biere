{% extends 'base.html.twig' %}

{% block title %}Hello CartController!{% endblock %}

{% block body %}

    <div class="action_back">
        <a href="{{path('products_index')}}" class="button_base button_back"><i class="fa-solid fa-chevron-left"></i> Retour boutique</a>
    </div>

    <h1>Panier</h1>

    {% if elements is defined and elements is not empty %}
        
        <table style="min-width:1000px;">
            <thead>
                <tr>
                    <th>Désignation du produit</th>
                    <th>Quantité</th>
                    <th>Prix</th>
                    <th>Sous-total</th>
                </tr>
            </thead>
            <tbody>
                {% for element in elements %}
                {# ELEMENTS DU PANIER #}
                    <tr>
                        <td> {{ element.product.designation }} {{ element.product.volume|number_format }}cl </td>
                        <td> 
                            <a href="{{ path('decrement_product_cart', {'id' : element.product.id})}}">--</a>
                            {{ element.quantity }} 
                            <a href="{{ path('increment_product_cart', {'id' : element.product.id})}}">++</a>
                        </td>
                        <td> {{ (element.product.price ?? 0 / 100) | number_format(2, ',', '.' ) }} €</td>
                        <td> {{ (element.SsTotal ?? 0 / 100) | number_format(2, ',', '.' ) }} € </td>
                        <td>  
                            <a href="{{ path('delete_product_cart', {"id" : element.product.id})}}"> 
                                <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 448 512" fill="red"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path d="M135.2 17.7C140.6 6.8 151.7 0 163.8 0H284.2c12.1 0 23.2 6.8 28.6 17.7L320 32h96c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 96 0 81.7 0 64S14.3 32 32 32h96l7.2-14.3zM32 128H416V448c0 35.3-28.7 64-64 64H96c-35.3 0-64-28.7-64-64V128zm96 64c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16z"/></svg>
                            </a>
                        </td>
                        
                    </tr>
                    {% if element.product.stock <= 0 %}
                        <tr>
                            <td colspan="4" style="font-size:0.7rem;color:red;font-style:italic;"> Rupture de stock : le délais de préparation de votre commande peut-être ralongé de quelques jours</td>
                        </tr>
                    {% elseif element.stockTemp < 0 %}
                        <tr>
                            <td colspan="4" style="font-size:0.7rem;color:red;font-style:italic;"> Avertissement : La quantité commandé dépasse la quantité en stock, le délais de préparation de votre commande peut-être ralongé de quelques jours</td>
                        </tr>
                    {% endif %}
                
                {% endfor %}
                {% if cotisation is defined and cotisation is not empty %}
                    {# COTISATION #}
                    <tr>
                        <td colspan="2"><span style="font-weight: 600;">Cotisation annuelle valable jusqu'au {{cotisation.endDate |date("d/m/Y", "Europe/Paris") }}  </span> </td>
                        <td>{{ (cotisation.price ?? 0 / 100) | number_format(2, ',', '.' ) }} €</td>
                    </tr>
                {% endif %}
                



                <tfoot>
                    <td colspan='2'>TOTAL</td>
                    <td> {{ (total ?? 0 / 100) | number_format(2, ',', '.' ) }} €</td>
                    <td colspan="2" style="text-align:right">  <a href="{{ path('delete_cart')}}" class="button_delete_cart">Supprimer le panier</a> </td>
                </tfoot>
            </tbody>

        </table>
            
        <div class="step_validation">
            <a href="{{ path ('checkBillingAddress')}}" class="button_base button_step_validation"> Valider mon panier </a>
        </div>
    {% else %}
        <p>Malheuresement votre panier est vide! </p>
    {% endif %}


    {% include "_partial/_assurance.html.twig" %}

    {% include "_partial/_bandeau_boissons.html.twig" %}
    
{% endblock %}
